"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["173"],{8050:function(n,e,a){a.r(e),a.d(e,{default:()=>i});var t=a(4246),s=a(980);function o(n){let e=Object.assign({h1:"h1",a:"a",div:"div",p:"p",strong:"strong",pre:"pre",code:"code",h2:"h2"},(0,s.ah)(),n.components);return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(e.h1,{id:"页面详情数据状态实例",children:["页面详情数据状态实例",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#页面详情数据状态实例",children:"#"})]}),"\n",(0,t.jsxs)(e.div,{className:"rspress-directive tip",children:[(0,t.jsx)(e.div,{className:"rspress-directive-title",children:"TIP"}),(0,t.jsxs)(e.div,{className:"rspress-directive-content",children:["\n",(0,t.jsx)(e.p,{children:"用于管理详情页面数据状态, 包含详情查询, 详情保存, 详情查询是否成功等状态"}),"\n"]})]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"引入"})}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"import { usePageInfoData } from '@fairys/taro-tools-react';\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"参数",children:["参数",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#参数",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-ts",children:"import { ProxyInstanceObjectBase } from '../utils/valtio/instance';\nexport interface PageDataInstanceState extends Object {\n    /**loading存储*/\n    loading?: Record<string, boolean>;\n    /**当前页*/\n    page?: number;\n    /**分页数*/\n    pageSize?: number;\n    /**总数*/\n    total?: number;\n    /**是否最后一页*/\n    hasLastPage?: boolean;\n    /**查询条件*/\n    search?: Object;\n    /**表格数据*/\n    dataList?: any[];\n    /**选择行数据*/\n    selectedRows?: any[];\n    selectedRowKeys?: any[];\n    /**数据默认值不使用*/\n    __defaultValue?: string;\n    [s: string]: any;\n}\nexport declare class PageDataInstance<T extends PageDataInstanceState = PageDataInstanceState> extends ProxyInstanceObjectBase<T> {\n    /**是否滚动加载分页*/\n    is_scroll_page: boolean;\n    /**默认值*/\n    defaultInital: T;\n    requestConfig?: {\n        /**请求之前处理参数*/\n        onBefore?: (payload: any, store: T) => Partial<T>;\n        /**请求接口*/\n        getList?: (payload: any) => Promise<{\n            code?: number;\n            data?: any;\n            message?: string;\n        }>;\n        /**请求之后处理返回值进行存储*/\n        onAfter?: (data: Record<string, any>) => Partial<T>;\n        /** code!==1 时 触发*/\n        onError?: (data: Record<string, any>) => void;\n    };\n    constructor(options?: PageDataOptions<T>);\n    store: T;\n    /**初始化状态值*/\n    main_page_store: (initalValues?: Partial<T>, file?: string[]) => this;\n    /**更新页面级的 pageLoading */\n    updatedLoading: (loading?: boolean) => void;\n    /**内置——查询列表*/\n    main_getList: () => Promise<void>;\n    /**内置——翻页*/\n    main_onPageChange: (page: number) => void;\n    /**内置——翻页切换*/\n    main_onShowSizeChange: (_: number, pageSize: number) => void;\n    /**内置——查询方法*/\n    main_onSearch: () => void;\n    /**加载更多*/\n    main_onLoadMore: () => void;\n}\nexport interface PageDataOptions<T extends PageDataInstanceState = PageDataInstanceState> {\n    /**请求配置*/\n    requestConfig?: PageDataInstance<T>['requestConfig'];\n    /**初始值*/\n    initialValues?: Partial<T>;\n    /**是否滚动加载更多*/\n    is_scroll_page?: boolean;\n}\n/**\n * 页面级数据状态管理\n */\nexport declare const usePageData: <T extends PageDataInstanceState = PageDataInstanceState>(options?: PageDataOptions<T>) => [T, PageDataInstance<T>, string | undefined];\n\n"})}),"\n",(0,t.jsxs)(e.h2,{id:"使用",children:["使用",(0,t.jsx)(e.a,{className:"header-anchor","aria-hidden":"true",href:"#使用",children:"#"})]}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-tsx",children:"import { usePageInfoData ，connectToastMessage} from '@fairys/taro-tools-react';\nimport { View, Button } from '@tarojs/components';\n\nconst Page = ()=> {\n    const [state, instance] = usePageInfoData({\n        /**详情查询请求配置*/\n        requestInfoConfig:{\n            getInfo:async (params) => {\n                console.log(params);\n                return {\n                    code: 200,\n                    data: {},\n                    message: '获取成功',\n                };\n            },\n        }\n        /**详情保存请求配置*/\n        requestSaveInfoConfig: {\n            onSaveInfo: async (params) => {\n                console.log(params);\n                return {\n                    code: 200,\n                    data: {},\n                    message: '保存成功',\n                };\n            },\n        }\n    })\n  return (\n    <View>\n      <Button onClick={()=>instance.main_getInfo({ id: 1 })}>获取详情</Button>\n      <Button onClick={()=>instance.main_saveInfo({ id: 1 })}>保存详情</Button>\n    </View>\n  )\n}\nexport default connectToastMessage(Page)\n\n"})})]})}function r(){let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:e}=Object.assign({},(0,s.ah)(),n.components);return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(o,{...n})}):o(n)}let i=r;r.__RSPRESS_PAGE_META={},r.__RSPRESS_PAGE_META["zh%2Fui%2Fcontext%2Fpage.info.md"]={toc:[{text:"参数",id:"参数",depth:2},{text:"使用",id:"使用",depth:2}],title:"页面详情数据状态实例",headingTitle:"页面详情数据状态实例",frontmatter:{}}}}]);